<?xml version="1.0" encoding="UTF-8"?> <rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"> <channel> <title>Charles Xu</title> <description>Essays, books, wiki on technologies, career, markets, and more.</description> <link>/</link> <atom:link href="/feed.xml" rel="self" type="application/rss+xml"/> <pubDate>Mon, 08 Nov 2021 20:10:50 -0800</pubDate> <lastBuildDate>Mon, 08 Nov 2021 20:10:50 -0800</lastBuildDate> <generator>Jekyll v4.2.0</generator> <item> <title>Accounting Advice for Founders</title> <description>&lt;p&gt;&lt;em&gt;Notes derived from a guest lecture by Danny Wallace, Partner at PwC’s Silicon Valley practice. For informational purposes only. Errors and omissions are my own.&lt;/em&gt;&lt;/p&gt; &lt;h3 id=&quot;collect-sales-tax-from-early-on&quot;&gt;Collect sales tax from early on&lt;/h3&gt; &lt;p&gt;Since the &lt;a href=&quot;https://www.supremecourt.gov/opinions/17pdf/17-494_j4el.pdf&quot;&gt;South Dakota v. Wayfair&lt;/a&gt; supreme court case, businesses without a physical presence in a state but with more than 200 transactions or $100,000 in-state sales should pay sales taxes in the state. Many startups did not collect sales tax at all, a mistake that will defer IPO and M&amp;amp;A deals. Fixing the sales tax issue is expensive for 2 reasons:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;You need to pay sales tax in arrears.&lt;/li&gt; &lt;li&gt;Starting to charge sales tax will hurt your growth numbers and hence valuation.&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Sales tax is an issue that comes up on every M&amp;amp;A deal. By all means, the company needs to get registered for sales tax and should seek professional advice.&lt;/p&gt; &lt;h3 id=&quot;classify-operating-expenses-cleverly-reduce-ga&quot;&gt;Classify operating expenses cleverly, reduce G&amp;amp;A&lt;/h3&gt; &lt;p&gt;Operating expenses are not created equal. We prefer R&amp;amp;D (research and development), and maybe S&amp;amp;M (sales and marketing), over G&amp;amp;A (general and administrative). Take advantage of the reporting flexibility of expense classification. For example, rent in the Bay Area is high, and some startups put rent under G&amp;amp;A, but we could allocate the rent to different items. Suppose you have one floor for G&amp;amp;A, one floor for R&amp;amp;D, and one floor for S&amp;amp;M, then we can only report a third of the rent under G&amp;amp;A.&lt;/p&gt; &lt;p&gt;Also, there are opportunities to capitalize the R&amp;amp;D expenses so they do not hit the income statement and go straight to the balance sheet and depreciate over time.&lt;/p&gt; &lt;h3 id=&quot;do-409a-valuation-every-year-and-proper-tax-withholding&quot;&gt;Do 409a valuation every year and proper tax withholding&lt;/h3&gt; &lt;p&gt;You must do a 409a valuation at least once a year, which will qualify for a safe harbor for the next 12 months. Otherwise, the IRS may challenge the tax status of the stock rewards to employees, and in turn, employees may sue the company for failure to perform 409a valuation properly.&lt;/p&gt; &lt;p&gt;Grant the stock rewards at the fair market value, or there will be tax consequences.&lt;/p&gt; &lt;p&gt;The company needs to issue 1099’s to the contractors. If the company does not, IRS will treat the contractors as employees. As the business expands globally, you also need to consider international taxes and work with professionals to design a global tax strategy.&lt;/p&gt; &lt;h3 id=&quot;watch-out-for-internal-fraud&quot;&gt;Watch out for internal fraud&lt;/h3&gt; &lt;p&gt;Especially in the seed and early stages, startups are plagued with internal fraud and misappropriation of the company’s assets. Two-thirds of all US-based small businesses fall victim to employee theft. Common schemes include expensing trips that never took place, claiming personal expenses as business ones, and falsifying sales for commissions.&lt;/p&gt; &lt;p&gt;Fraud is common at this stage because companies often have no formal processes in place, and operators are too busy with getting the business off the ground. The companies should minimize the number of corporate credit cards and require approvals for all purchases and transfers above a certain threshold. At the same time, strengthen the hiring process with reference checks and background checks. Set up a whistleblower hotline.&lt;/p&gt; &lt;h3 id=&quot;always-verify-communication-with-a-second-means&quot;&gt;Always verify communication with a second means&lt;/h3&gt; &lt;p&gt;External fraud is also prevalent, with the most common one being phishing emails for wire transfer. Examples of spoofed emails are the CEO asking emergency wire transfer for a confidential deal, or a vendor requesting for updating bank information. Or the hackers may fake a login page to get your internal systems credentials, risking your intellectual property and employee data. Spoofing could also be in physical mails.&lt;/p&gt; &lt;p&gt;You should always verify the intent with a second means, such as calling the alleged sender directly and set up multi-factor authentication.&lt;/p&gt; &lt;h3 id=&quot;think-twice-before-publishing-key-metrics-protect-data-integrity&quot;&gt;Think twice before publishing key metrics, protect data integrity&lt;/h3&gt; &lt;p&gt;Besides items from financial statements, a company may choose to publish key metrics specific to the business, such as monthly active users, number of paying customers, net retention rate, number of completed trips, etc. You need to clearly define and consistently measure the key metrics. Once you publish such metrics, you need to continue doing so going forward. Data integrity and history are crucial. Investors will sue for any misrepresentation of the metrics. Similar to how you should prevent internal fraud, make sure you have internal control in place.&lt;/p&gt; &lt;h3 id=&quot;own-your-revenue-model-ratable-or-non-ratable-net-or-gross&quot;&gt;Own your revenue model: ratable or non-ratable, net or gross&lt;/h3&gt; &lt;p&gt;There is a trade-off between the ratable and non-ratable revenue models. Ratable means proportional. Ratable models recognize service revenue over time as services are provided. The revenue schedule is defined in the contract elements. Ratable models are more predictable and offer more visibility into the company. For example, SaaS companies with mouthy subscriptions can provide great guidance to investors with a high degree of confidence. However, ratable models are less tweakable. For example, at the end of the quarter, if you risk missing the forecast numbers, you cannot just send salespeople out to get deals done on the last day of the quarter. Even if you do so, you recognize only one day of revenue.&lt;/p&gt; &lt;p&gt;Another dimension of the revenue model is gross vs net, especially for marketplace and platform businesses. For example, Uber follows the net revenue model. If Uber collects $10 from a rider, pays the driver $8, pockets $2, Uber will recognize $2 revenue instead of $10, and $0 COGS instead of $8, because its terms and conditions say it is a platform company connecting drivers and riders.&lt;/p&gt; </description> <pubDate>Thu, 05 Aug 2021 00:00:00 -0700</pubDate> <link>/accounting/</link> <guid isPermaLink="true">/accounting/</guid> <category>accounting</category> <category>startup</category> </item> <item> <title>Intellectual Property and Entrepreneurship</title> <description>&lt;p&gt;&lt;em&gt;Notes on Intellectual Property (IP) law for founders and busy professionals. Not legal advice. For informational purposes only. Laws can change, so this article may contain dated information. Always consult an attorney.&lt;/em&gt;&lt;/p&gt; &lt;h3 id=&quot;the-big-4&quot;&gt;The big 4&lt;/h3&gt; &lt;h4 id=&quot;patents&quot;&gt;Patents&lt;/h4&gt; &lt;p&gt;Patents protect novel, useful, non-obvious inventions. With full disclosure of the innovation, a patent grants the right to exclude others from making, using, selling, offering to sell, or importing the invention. It does not require its owner to use the patent.&lt;/p&gt; &lt;h4 id=&quot;copyright&quot;&gt;Copyright&lt;/h4&gt; &lt;p&gt;Copyright protects original works of authorship fixed in any tangible medium of expression, such as source code, art (painting, photographs, acting), and sculpture.&lt;/p&gt; &lt;p&gt;Copyright does not protect functionality but only the expression. The author must independently create the work (no copying) and display some level of creativity. Copyright is secured automatically when the work is created.&lt;/p&gt; &lt;p&gt;Copyright owners have the exclusive right to create copyrightable derivative works, unless others obtain a licence from the owner. However, fair use is often a defense against infringement claims. Reverse engineering of competing products is fair use, but you can protect against reverse engineering using contracts. There are 4 factors to evaluate a fair use defense. Talk to your attorney.&lt;/p&gt; &lt;h4 id=&quot;trademark&quot;&gt;Trademark&lt;/h4&gt; &lt;p&gt;A trademark is a word/phrase/logo that identifies the source of goods. To register as a trademark the name of a well-known political figure and celebrity, their written consent is needed. Colors can be a trademark. Think Tiffany blue.&lt;/p&gt; &lt;h4 id=&quot;trade-secrets&quot;&gt;Trade secrets&lt;/h4&gt; &lt;p&gt;Trade secrets protect confidential company information that is commercially valuable and not publicly known, such as the Coca-Cola Coke formula. They do not require any registration with government agencies. Patent applications are considered trade secrets by the USPTO until their eventual publication.&lt;/p&gt; &lt;p&gt;The trade secret owner must have demonstrable intent to maintain confidentiality (use NDAs). Trade secrets can be licensed.&lt;/p&gt; &lt;h3 id=&quot;ideas-are-not-ip&quot;&gt;Ideas are not IP&lt;/h3&gt; &lt;p&gt;IP law only protects the embodiment (expression, implementation) of ideas. Because ideas are not IP, they are not proprietary (i.e. cannot be owned), but they can be confidential (i.e. secrets).&lt;/p&gt; &lt;p&gt;However, ideas may be protected with contracts, such as nondisclosure agreements (NDA) or payment agreements. California law might imply a contract in certain cases, but a contract will not be implied if the disclosure occurs before it is known that payment is a condition of use.&lt;/p&gt; &lt;h3 id=&quot;nondisclosure-agreements&quot;&gt;Nondisclosure agreements&lt;/h3&gt; &lt;p&gt;Without an NDA, discussion of any invention is considered public disclosure, which prevents you from filing patents and voids your trade secrets. VCs do not sign NDAs. Hence, when pitching to VCs, 1) focus on the business and market, and 2) file a provisional patent application to lock in the priority date before talking to anyone who is not an inventor.&lt;/p&gt; &lt;p&gt;Like all agreements, an NDA must state the parties bounded by the agreement with date and signatures. It should identify the information discloser and receiver. It should describe with sufficient particularity the information to be disclosed. Saying that the NDA covers “everything provided” is likely to be not enforceable. The NDA should state the intended purpose and limitations of the use of the disclosed information (e.g. not a license to IP and cannot be used to develop any product). Make sure to mark confidential documents as such. Define the duration for disclosure exchange and for confidentiality preservation. Declare which state or country law governs the interpretation of the agreement.&lt;/p&gt; &lt;p&gt;Avoid the “residuals” provision, which says it is okay to use things remembered in memory.&lt;/p&gt; &lt;h3 id=&quot;patents-1&quot;&gt;Patents&lt;/h3&gt; &lt;p&gt;Utility patents have a 20-year life from the application date and cannot be extended. Patents are granted to the first to file. Laws of nature (theorem, algorithm) and products of nature (animals) are not patentable. The patent owners, not the government, police their patent rights.&lt;/p&gt; &lt;p&gt;A provisional application is recommended not only because it secures an earlier priority date but also because filing patents is expensive (thousands of dollars before lawyer fee) and time-consuming (takes about 25 months to issue), so the 1-year grace period allows the inventor to evaluate the business strategy to decide if patent filing is worth it. Patent protection does not start until the patent issues.&lt;/p&gt; &lt;p&gt;A patent requires the invention to be novel. An invention is not novel if it is anticipated (identical to a prior art). Public disclosures—talking to noninventors, publication, selling, offering to sell—count as prior art. So again, NDAs and provisional applications are recommended.&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;That which will infringe, if later, will anticipate, if earlier.&lt;/p&gt; &lt;p&gt;– &lt;em&gt;Peters v. Active Mfg.&lt;/em&gt;, 21 F. 319&lt;/p&gt; &lt;/blockquote&gt; &lt;p&gt;Patents are always issued on Tuesday. Why? Because the USPTO said so.&lt;/p&gt; &lt;p&gt;Patent claims must be written in one sentence. Why? Because the USPTO said so.&lt;/p&gt; &lt;p&gt;A patent licensee may challenge the patent (e.g. that it was anticipated) while retaining a licence to the patent. If you lose the patent challenge, you still have the licence.&lt;/p&gt; &lt;p&gt;AI cannot be an inventor, who must a human being.&lt;/p&gt; &lt;h3 id=&quot;employment-agreements&quot;&gt;Employment agreements&lt;/h3&gt; &lt;p&gt;An employment agreement likely includes an IP assignment agreement, meaning IP created within the scope of employment is owned by the employer. The employer owns the code written by its engineers, but not the code written by janitors.&lt;/p&gt; &lt;p&gt;Always include such assignment agreement, essentially for contractors. Do not use the phrase “work made for hire”, which in California makes a contractor an employee. The assignment agreement will protect the company in case some employees leave and start their own thing using the same IP.&lt;/p&gt; &lt;h4 id=&quot;california-safe-harbor&quot;&gt;California safe harbor&lt;/h4&gt; &lt;p&gt;The assignment agreement with the employer does not apply to inventions an employee developed entirely on their own time without using the employer’s equipment, supplies, facilities, or trade secret. However, exceptions are&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;(1) Relate at the time of conception or reduction to practice of the invention to the employer’s business, or actual or demonstrably anticipated research or development of the employer; or&lt;/p&gt; &lt;p&gt;(2) Result from any work performed by the employee for the employer.&lt;/p&gt; &lt;p&gt;– California labor code section 2870 (a)&lt;/p&gt; &lt;/blockquote&gt; &lt;p&gt;It is always a peril when someone is still employed elsewhere while also working on the startup. This person probably also signed IP assignment agreement with that other employer, and exception (2) above makes things really tricky.&lt;/p&gt; &lt;p&gt;Ideally, have a clean cut. Quit former employer, start the company, then develop. This issue always comes up during due diligence when you raise funding or seek exits.&lt;/p&gt; &lt;h3 id=&quot;ownership-and-multiple-creators&quot;&gt;Ownership and multiple creators&lt;/h3&gt; &lt;p&gt;For every type of IP, the default owner is the creators:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;patents: inventors&lt;/li&gt; &lt;li&gt;copyrights: authors&lt;/li&gt; &lt;li&gt;trademark: first user in commerce&lt;/li&gt; &lt;li&gt;trade secrets: creators&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;The legal default is that creators are the joint owners of equal rights regardless of the disparity in contribution. Equal ownership can only be shifted by assignment agreements.&lt;/p&gt; &lt;p&gt;Among co-owners, licensing rights are often the most contentious. To avoid disputes, one option is to divide up the right so that each owner will have exclusive rights to grant licenses only in a particular industry or country.&lt;/p&gt; &lt;p&gt;In community property states, such as California, spouses have ownership rights in IP created by the other spouse during the term of the marriage.&lt;/p&gt; &lt;p&gt;As shown below, there are unique ownership issues for different types of IP.&lt;/p&gt; &lt;h4 id=&quot;patents-2&quot;&gt;Patents&lt;/h4&gt; &lt;p&gt;Absent written agreement, all inventors can each independently license to third parties without any duty or notice to co-inventors, perhaps with inconsistent terms. Hence, co-owners could compete with each other.&lt;/p&gt; &lt;h4 id=&quot;copyrights&quot;&gt;Copyrights&lt;/h4&gt; &lt;p&gt;Absent written agreement, each owner can independently license to third parties on inconsistent terms, but contrary to patent law, all co-owners have a duty to each other to provide financial accounting and share the proceeds from licensing. Such duty can be changed with written agreements.&lt;/p&gt; &lt;h4 id=&quot;trademarks&quot;&gt;Trademarks&lt;/h4&gt; &lt;p&gt;It is the business, not the creators that own the trademark. The artistic appearance of the trademark might be protected by copyright. Do not use the logo unless the copyright is assigned or licensed to the company, especially when the logo is produced by a contractor.&lt;/p&gt; &lt;h3 id=&quot;open-source-software-oss-licensing&quot;&gt;Open-source software (OSS) licensing&lt;/h3&gt; &lt;p&gt;The following 6 OSS licenses cover 99% of the use case.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Copy-left licenses (free software)&lt;/strong&gt;:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;GPL&lt;/li&gt; &lt;li&gt;LGPL&lt;/li&gt; &lt;li&gt;Eclipse Public License, CDDL, Mozilla Public License (these 3 are effectively identical)&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;&lt;strong&gt;Permissive licenses&lt;/strong&gt;:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;BSD&lt;/li&gt; &lt;li&gt;MIT&lt;/li&gt; &lt;li&gt;Apache 2&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Permissive licenses allow the user to do whatever as long as the license header is kept.&lt;/p&gt; &lt;p&gt;Copy-left licenses require that if you distribute your software in binary form, you must make the corresponding source code available to binary recipients and only license your code on the same copy-left licensing terms.&lt;/p&gt; &lt;p&gt;Distribution is the key here because it is a right under the US copyright law. Distribution means transferring a copy from a legal person to another. Absent distribution, most OSS licenses impose no condition. For most licenses, SaaS is not considered distribution, but pay attention to the recent trend of adoption of the &lt;a href=&quot;https://en.wikipedia.org/wiki/Server_Side_Public_License&quot;&gt;Server Side Public License&lt;/a&gt;.&lt;/p&gt; &lt;p&gt;Copy-left licenses have different levels of restriction as shown below.&lt;/p&gt; &lt;h4 id=&quot;gpl---strong-copyleft&quot;&gt;GPL - strong copyleft&lt;/h4&gt; &lt;p&gt;if any code in a program is GPL, it must all be GPL. This means no proprietary code in a GPL codebase and no linking to proprietary code, because linking is a process that creates executables, as opposed to ways of inter-process communication. In a GPL codebase, code may come from other GPL compatible licenses, such as permissive licenses.&lt;/p&gt; &lt;p&gt;Everything in kernel space is GPL. Proprietary code in the kernel space is risky. Application code that communicates with the kernel through syscalls can be proprietary.&lt;/p&gt; &lt;h4 id=&quot;lgpl---library-copyleft&quot;&gt;LGPL - library copyleft&lt;/h4&gt; &lt;p&gt;If any code in a library is LGPL, then the entire library is LGPL. However, you can dynamically link to proprietary code, which means you need to share changes to the library but not the code using the library. Static linking to proprietary code might be permitted but most companies decided not to after talking to their attorneys. Note that scripting languages basically work by the equivalent of dynamic linking for the purpose of this analysis.&lt;/p&gt; &lt;h4 id=&quot;mozilla-eclipse-cddl---weak-copyleft&quot;&gt;Mozilla, Eclipse, CDDL - weak copyleft&lt;/h4&gt; &lt;p&gt;With no rules about linking, these licenses are friendly to proprietary code, which should be kept in a separate file. If you did not modify the licensed code, you easily comply. If you did modify, a simple legal review can help you comply.&lt;/p&gt; </description> <pubDate>Thu, 06 May 2021 00:00:00 -0700</pubDate> <link>/ip-law/</link> <guid isPermaLink="true">/ip-law/</guid> <category>law</category> <category>startup</category> </item> <item> <title>Life and Investment Through the Lens of Uncertainty</title> <description>&lt;p&gt;&lt;em&gt;Disclaimer: Opinions are my own. Not investment advice.&lt;/em&gt;&lt;/p&gt; &lt;h3 id=&quot;decisions-are-not-judged-by-results&quot;&gt;Decisions are not judged by results&lt;/h3&gt; &lt;p&gt;Decisions and results are separate. The quality of a decision should not be judged by the quality of its result, which often depends on randomness.&lt;/p&gt; &lt;p&gt;If I drove drunk yet got home safely, I have made a bad decision with a good outcome. If I drove sober and careful but was rear-ended, I have made a good decision with a bad outcome.&lt;/p&gt; &lt;p&gt;If I rushed into $NIO upon open, dumped before close, and netted some decent gain, did I make a good decision? So much of one’s success was attributed to the research and painstaking, often confusing luck with skills, and signal with noise.&lt;/p&gt; &lt;p&gt;In the last 20 years, $SPY has a nontrivial mean daily return of 0.0338% but a standard deviation of 1.2405%, which is 37 times the return. Holding it for just a day is really speculating as opposed to investing.&lt;/p&gt; &lt;p&gt;We always make decisions under uncertainty, but our weapons are legions—probability, expectation, and Monte Carlo.&lt;/p&gt; &lt;h3 id=&quot;vanish-of-randomness&quot;&gt;Vanish of randomness&lt;/h3&gt; &lt;p&gt;Suppose we treat each daily return &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R1, R2, ..., Rn&lt;/code&gt; as a random variable from the same distribution—any distribution, especially not Normal. Suppose the distribution has a mean &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mu&lt;/code&gt; and standard deviation &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sigma&lt;/code&gt;. Then, the sum of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R1, R2, ..., Rn&lt;/code&gt; has mean &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;n * mu&lt;/code&gt; and and standard deviation &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sqrt(n) * sigma&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;In layman’s terms, the longer you hold a stock, the narrower the distribution of its return. If you end up with a spike, it means you almost always make money.&lt;/p&gt; &lt;p&gt;This analysis is simplified and assumes the underlying distribution does not change. The real distribution is not observable, but with so many pension and retirement funds in the market, your investment positions are also a reflection of your confidence in the federal government.&lt;/p&gt; &lt;h3 id=&quot;uncertainty-has-existed-in-the-past&quot;&gt;Uncertainty has existed in the past&lt;/h3&gt; &lt;p&gt;Uncertainty implies unknown and seems applicable only to future events. After all, I cannot predict the tomorrow price of a stock, but I know for sure what its price was yesterday. The past can only be learned but not altered.&lt;/p&gt; &lt;p&gt;Yet uncertainty has existed in the past. The price went up yesterday, but it &lt;em&gt;could&lt;/em&gt; have gone down. Be very careful with past observations. What has happened is only one of the possibilities. Watch out for the “alternative” histories, cried &lt;a href=&quot;https://en.wikipedia.org/wiki/Nassim_Nicholas_Taleb&quot;&gt;Nassim Nicholas Taleb&lt;/a&gt;. If a certain kind of events—no one has seen a black swan, or the market has never gone down more than 20% in a day—has never been observed before, we cannot conclude it is impossible.&lt;/p&gt; &lt;h3 id=&quot;stay-in-the-game&quot;&gt;Stay in the game&lt;/h3&gt; &lt;p&gt;The black swan is not scary as long as you can keep playing. Stay away from &lt;a href=&quot;https://en.wikipedia.org/wiki/Russian_roulette&quot;&gt;Russian roulette&lt;/a&gt;. No matter how lucrative the upside is, there is no come back if you get wiped out. Limit tail risk. Always fasten the seat belt.&lt;/p&gt; &lt;h3 id=&quot;know-your-tools&quot;&gt;Know your tools&lt;/h3&gt; &lt;p&gt;Through what instruments, you asked. It is like choosing the tech stack for your startup: always the ones you know.&lt;/p&gt; &lt;p&gt;Call options have the leverage and convexity that bends in your favor regardless of the price going up or down, or so you have overheard in an anonymous web forum. Not entirely in apropos, but at what cost? What if the price remains stationary? Hint: look into &lt;a href=&quot;https://en.wikipedia.org/wiki/Greeks_(finance)#Theta&quot;&gt;theta&lt;/a&gt; risk.&lt;/p&gt; &lt;h3 id=&quot;being-reasonable-not-rational&quot;&gt;Being reasonable, not rational&lt;/h3&gt; &lt;p&gt;It is never about achieving the most optimal return, but a good enough one that allows me to sleep at night and achieves my life goals. Investing is a means to an end. Be patient and start living.&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;Warren Buffett’s skill is investing, but his secret is time.&lt;/p&gt; &lt;p&gt;– Morgan Housel, The Psychology of Money&lt;/p&gt; &lt;/blockquote&gt; </description> <pubDate>Sun, 03 Jan 2021 00:00:00 -0800</pubDate> <link>/uncertain/</link> <guid isPermaLink="true">/uncertain/</guid> <category>investment</category> <category>career</category> </item> <item> <title>Navigating Shell for Productivity and Profit</title> <description>&lt;p&gt;I hope you find inspirations from these pretty neat shell tricks and my shell setup.&lt;/p&gt; &lt;h3 id=&quot;array-expansion&quot;&gt;Array Expansion&lt;/h3&gt; &lt;p&gt;Use Array Expansion to quickly build arguments to a command. For example, to download several HTTP resources:&lt;/p&gt; &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ wget https://kubernetespodcast.com/episodes/KPfGep{001..062}.mp3 &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;To rename files when you just want to change a substring.&lt;/p&gt; &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ mv /path/to/same-prefix-{old,new}.txt &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h3 id=&quot;process-substitution-and-anonymous-files&quot;&gt;Process Substitution and Anonymous Files&lt;/h3&gt; &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;()&lt;/code&gt; redirects the stdout of the command in the subshell to a file descriptor opened at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/fd&lt;/code&gt;. This is known as process substitution.&lt;/p&gt; &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ sh &amp;lt;(curl -sL https://istio.io/downloadIstioctl) &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;The above is equivalent to the following, where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-&lt;/code&gt; means to use the stdin as a file.&lt;/p&gt; &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ curl -sL https://istio.io/downloadIstioctl | sh - &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;Note that process substitution is more powerful than pipes, since you can do things like&lt;/p&gt; &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ diff &amp;lt;(ssh somehost cat /etc/hosts) &amp;lt;(ssh some-other-host cat /etc/hosts) &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h3 id=&quot;start-new-shell&quot;&gt;Start new shell&lt;/h3&gt; &lt;p&gt;Just updated your bashrc/zshrc file, but want to hold on to your environment variables, file descriptors, etc? Do this.&lt;/p&gt; &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ exec -l $SHELL &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h3 id=&quot;the-password-is-sudo&quot;&gt;The password is sudo&lt;/h3&gt; &lt;p&gt;Dealing with production outage and in dire need of mitigation?&lt;/p&gt; &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ sudo su &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;And then you are always the root master. “I don’t test in prod; I dev in prod.”&lt;/p&gt; &lt;h3 id=&quot;alias-for-the-win&quot;&gt;Alias for the Win&lt;/h3&gt; &lt;p&gt;Type less. Move fast. Here are some I use everyday.&lt;/p&gt; &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 8 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;mcd&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; cdl&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;alias ls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ls -F -G'&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;alias &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ls -lh'&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;alias &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'open'&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;alias &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ping -c 5'&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;alias &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;gauth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'gcloud auth login --update-adc'&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;(I consider it a work injury that I now quote everything in shell and has long stopped using white space in file names even for personal stuff. Maybe you are like me.)&lt;/p&gt; &lt;h3 id=&quot;cursor-navigation&quot;&gt;Cursor Navigation&lt;/h3&gt; &lt;div style=&quot;text-align: center&quot;&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/shell/1.png&quot; width=&quot;1680&quot; /&gt;&lt;/p&gt; &lt;/div&gt; &lt;h3 id=&quot;command-deletion&quot;&gt;Command Deletion&lt;/h3&gt; &lt;div style=&quot;text-align: center&quot;&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/shell/2.png&quot; width=&quot;1680&quot; /&gt;&lt;/p&gt; &lt;/div&gt; &lt;h3 id=&quot;in-line-file&quot;&gt;In-line file&lt;/h3&gt; &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 8 9 10 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;EOF&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt; | kubectl create -f - apiVersion: v1 kind: Pod metadata: name: nginx spec: containers: - name: nginx image: nginx &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EOF &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h3 id=&quot;search-command-history-with-fuzzy-find&quot;&gt;Search Command History with Fuzzy Find&lt;/h3&gt; &lt;p&gt;You probably know you could use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ctrl+r&lt;/code&gt; to retrieve a previously executed command quickly, but it only gives you one suggestion. &lt;a href=&quot;https://github.com/junegunn/fzf&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fzf&lt;/code&gt;&lt;/a&gt; solves it not only for commands but finds files as well.&lt;/p&gt; &lt;div style=&quot;text-align: center&quot;&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/shell/3.png&quot; width=&quot;1680&quot; /&gt;&lt;/p&gt; &lt;/div&gt; &lt;h3 id=&quot;auto-correct-command-typos&quot;&gt;Auto-correct Command Typos&lt;/h3&gt; &lt;p&gt;I don’t endorse profanity but we all share the frustration. &lt;a href=&quot;https://github.com/nvbn/thefuck&quot;&gt;Thefuck&lt;/a&gt; will correct your mistake.&lt;/p&gt; &lt;div style=&quot;text-align: center&quot;&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/shell/4.gif&quot; width=&quot;1680&quot; /&gt;&lt;/p&gt; &lt;/div&gt; &lt;h3 id=&quot;zsh-ohmyzsh-and-powerlevel10k&quot;&gt;ZSH, ohmyzsh, and powerlevel10k&lt;/h3&gt; &lt;p&gt;ZSH, or Z shell, is an extended version of the Bourne Shell (sh), with numerous new features, plugins, and themes. To change your shell to ZSH&lt;/p&gt; &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;$ chsh -s $(which zsh) &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;&lt;a href=&quot;https://github.com/ohmyzsh/ohmyzsh&quot;&gt;Ohmyzsh&lt;/a&gt; is a plugin manager for ZSH. I recommend at least two plugins.&lt;/p&gt; &lt;p&gt;&lt;a href=&quot;https://github.com/zsh-users/zsh-autosuggestions&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;autosuggestions&lt;/code&gt;&lt;/a&gt; makes zsh like fish.&lt;/p&gt; &lt;div style=&quot;text-align: center&quot;&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/shell/5.png&quot; width=&quot;1680&quot; /&gt;&lt;/p&gt; &lt;/div&gt; &lt;p&gt;&lt;a href=&quot;https://github.com/zsh-users/zsh-syntax-highlighting&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;syntax-highlighting&lt;/code&gt;&lt;/a&gt; colorizes the command and strings, providing visual warning for typos.&lt;/p&gt; &lt;div style=&quot;text-align: center&quot;&gt; &lt;p&gt;&lt;img src=&quot;/assets/images/shell/6.png&quot; width=&quot;300&quot; /&gt;&lt;/p&gt; &lt;/div&gt; </description> <pubDate>Fri, 20 Nov 2020 00:00:00 -0800</pubDate> <link>/shell/</link> <guid isPermaLink="true">/shell/</guid> <category>shell</category> </item> <item> <title>Software Engineering Levels and Promotion</title> <description>&lt;p&gt;This post explains the expectation of each engineering level in the most concise and company-agnostic way and reveals the steps towards promotion.&lt;/p&gt; &lt;h3 id=&quot;levels&quot;&gt;Levels&lt;/h3&gt; &lt;p&gt;The first step to prepare for promotion is to understand the expectation of each level. Having worked at several companies ranging from &lt;a href=&quot;https://www.investopedia.com/terms/f/faang-stocks.asp&quot;&gt;FAANG&lt;/a&gt; to startups in the valley, I noticed that the engineering leveling systems are awfully similar.&lt;/p&gt; &lt;h5 id=&quot;new-grad--entry-level-l3&quot;&gt;New grad / Entry-level (L3)&lt;/h5&gt; &lt;ul&gt; &lt;li&gt;Deliver assigned tasks timely and independently&lt;/li&gt; &lt;/ul&gt; &lt;h5 id=&quot;software-engineer-l4&quot;&gt;Software Engineer (L4)&lt;/h5&gt; &lt;ul&gt; &lt;li&gt;Design, implement, and operate scalable systems for well-scoped projects&lt;/li&gt; &lt;/ul&gt; &lt;h5 id=&quot;senior-engineer-l5&quot;&gt;Senior Engineer (L5)&lt;/h5&gt; &lt;ul&gt; &lt;li&gt;Define and scope undefined problems given defined goals&lt;/li&gt; &lt;li&gt;Substantial impact within the team &lt;ul&gt; &lt;li&gt;Mentoring junior engineers&lt;/li&gt; &lt;li&gt;Technical oversight&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;/ul&gt; &lt;h5 id=&quot;staff-engineer-l6&quot;&gt;Staff Engineer (L6)&lt;/h5&gt; &lt;ul&gt; &lt;li&gt;Propose and drive cross-functional initiatives, define goals, identify and connect stakeholders&lt;/li&gt; &lt;/ul&gt; &lt;h5 id=&quot;senior-staff-engineer--principal-engineer-l7&quot;&gt;Senior Staff Engineer / Principal Engineer (L7+)&lt;/h5&gt; &lt;ul&gt; &lt;li&gt;It becomes stratospheric from here. Engineers at such levels are experts in their domains.&lt;/li&gt; &lt;li&gt;Invent and evangelize new products and technologies&lt;/li&gt; &lt;/ul&gt; &lt;h3 id=&quot;promotions&quot;&gt;Promotions&lt;/h3&gt; &lt;p&gt;There are many moving pieces when you work towards a promo. If you forget everything I shared in this post, try to remember this: the single most important thing to do for a promo is &lt;strong&gt;&lt;em&gt;consistently delivering projects at the next level of scope&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt; &lt;p&gt;This is also one of the reasons (besides budgeting) why promotion is getting slower and harder to come by at some of FAANG, because with the money-printing success of the company’s business model, development work gradually shifts towards keeping the lights on.&lt;/p&gt; &lt;p&gt;Below are generic steps towards a promotion.&lt;/p&gt; &lt;h4 id=&quot;step-1-reasonable-manager&quot;&gt;Step 1: Reasonable manager&lt;/h4&gt; &lt;p&gt;The promotion process, as well as one’s life, depends more or less on luck on getting the right manager and projects. Without a supportive manager, promotion is rather difficult, because your manager is the person who represents you in the calibration and promo committee review.&lt;/p&gt; &lt;p&gt;At least, your manager should view people development as part of her job and believe that you have the potential to grow into the next level. If you unfortunately end up in some &lt;a href=&quot;https://www.susanjfowler.com/blog/2017/2/19/reflecting-on-one-very-strange-year-at-uber&quot;&gt;toxic&lt;/a&gt; work environment, there are ways to get promo too that I do not recommend. Instead, my suggestion in this case would be to run away screaming (change team or company).&lt;/p&gt; &lt;h4 id=&quot;step-2-identify-gaps&quot;&gt;Step 2: Identify gaps&lt;/h4&gt; &lt;p&gt;Engage with your manager in your &lt;a href=&quot;/one-on-one&quot;&gt;weekly one on one&lt;/a&gt;, to share your career aspiration and together identify the gaps between your current and the next level. Two things to keep in mind:&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Seek actionable feedback.&lt;/strong&gt; If you are L3 and your manager says the tasks you have delivered are not technically challenging enough, this feedback probably is not actionable for you, because you are likely not the person deciding on which tasks to focus on. An example of actionable feedback is to “be more vocal about your opinions by speaking up more in meetings and commenting on design docs”.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Perception is reality.&lt;/strong&gt; If your manager thinks you have a communication problem, then you need to solve this communication problem to get promo. You may disagree with such diagnosis, or there might be underlying causes for such a symptom, but your manager’s perception is what matters here.&lt;/p&gt; &lt;h4 id=&quot;step-3-find-the-right-projects&quot;&gt;Step 3: Find the right projects&lt;/h4&gt; &lt;p&gt;To repeat from the opening of this section, the key to promotion is to deliver projects at the next level of impact.&lt;/p&gt; &lt;p&gt;At L3/4, finding such projects are easy. Most projects permit designs that go on an extra mile in terms of feature, scalability, testability, and operational excellence.&lt;/p&gt; &lt;p&gt;At L5 and beyond, it gets a bit tricky. Most teams do not have a backlog of L6 projects, which is one of the reasons why many plateau at L5. So again, luck (right place and the right time) is needed for promo. Your manager and maybe tech lead are responsible for prioritization and project scoping. Make sure to loop them in to strategize for these projects.&lt;/p&gt; &lt;h4 id=&quot;step-4-learn-and-grow&quot;&gt;Step 4: Learn and grow&lt;/h4&gt; &lt;p&gt;Learn all the new technologies. Build healthy relationships with sister teams. Execute on the projects. Establish competencies.&lt;/p&gt; &lt;h4 id=&quot;step-5-demonstrate-impact&quot;&gt;Step 5: Demonstrate impact&lt;/h4&gt; &lt;p&gt;You may believe in meritocracy and think the excellence of your work warrants attention and rewards, or perhaps you are being humble. Yet the reality is that most people are too busy to look if you do not point them in your direction.&lt;/p&gt; &lt;p&gt;Bombast about yourself feels awkward and might backfire. The trick is to let other people praise you, especially those who are at high levels than your target level. Relationship is important not only because it may unblock your project dependencies but also because many, after all, judge books by covers and believe trusts are transitive.&lt;/p&gt; &lt;p&gt;Prefer written evidence if you can, such as design docs you authored, video recording of your demo at all-hands, and thank you notes / peer bonus.&lt;/p&gt; &lt;p&gt;Following these steps and with sustained performance at the next level, promotion is yours. If not, did I mention luck and having a reasonable manager? My run-away-screaming advice still holds.&lt;/p&gt; </description> <pubDate>Mon, 31 Aug 2020 00:00:00 -0700</pubDate> <link>/promo/</link> <guid isPermaLink="true">/promo/</guid> <category>career</category> </item> <item> <title>What to Talk about in Effective 1-on-1s</title> <description>&lt;p&gt;Unlike in school when we get grades on every assignment and in every course, we get less frequent feedback in professional life, usually once or twice per year, which is also when compensation and level adjustment happens.&lt;/p&gt; &lt;p&gt;The infrequent feedback might be frustrating, since it introduces artificial delays in recognizing and acting on improvement opportunities. Careers management is not so different from product management—fast iterations of small improvements are the proven route towards success.&lt;/p&gt; &lt;p&gt;One-on-one meetings allow a much smaller feedback cycle. You should schedule regular one-on-ones with your direct manager, if not your skip manager as well. However, it is not trivial to run effective one-on-ones. Sometimes they become status updates or are simply skipped over (Pro tip: don’t cancel but reschedule instead). Just like you own your career, you also own the one-on-ones.&lt;/p&gt; &lt;p&gt;Here are some good questions to ask your manager or share your answers with your manager.&lt;/p&gt; &lt;h3 id=&quot;what-to-talk-about&quot;&gt;What to talk about&lt;/h3&gt; &lt;p&gt;In this context, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;you&lt;/code&gt; means the manager and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;I&lt;/code&gt; represents the individual contributor.&lt;/p&gt; &lt;h4 id=&quot;career-and-performance&quot;&gt;Career and Performance&lt;/h4&gt; &lt;h5 id=&quot;how-am-i-meeting-your-expectation&quot;&gt;How am I meeting your expectation?&lt;/h5&gt; &lt;p&gt;Could you help me understand what the expectations of me are at my current level? What does “Exceeds Expectation” rating mean in the context of our team? From what you have seen in calibration and performance review, what are the set of projects and impacts I should aim for to reach such a rating?&lt;/p&gt; &lt;h5 id=&quot;what-is-my-next-career-goal-could-you-help-me-identify-the-specific-gaps-between-where-i-am-and-my-goal-what-are-the-and-action-items-to-bridge-the-gap&quot;&gt;What is my next career goal? Could you help me identify the specific gaps between where I am and my goal? What are the and action items to bridge the gap?&lt;/h5&gt; &lt;ul&gt; &lt;li&gt;To grow into a senior/staff engineer or an engineering manager requires different skills and experience. You want your manager to know your aspiration and together devise a plan to achieve it. How can the manager be helpful without knowing what you want?&lt;/li&gt; &lt;li&gt;Whose job do I want in the future? Do I know what their functions are?&lt;/li&gt; &lt;/ul&gt; &lt;h4 id=&quot;team-and-satisfaction&quot;&gt;Team and Satisfaction&lt;/h4&gt; &lt;h5 id=&quot;am-i-happy-with-the-projects-i-am-working-on&quot;&gt;Am I happy with the projects I am working on?&lt;/h5&gt; &lt;ul&gt; &lt;li&gt;Is it too much operation than development? Am I learning new skills? Can I accomplish my tasks? &lt;ul&gt; &lt;li&gt;An ideal job/project should mandate a level of expertise of which I satisfy 60%. Anything more will be trivial to solve and not enough growth for me, but anything less will be overwhelming and set me up for failure.&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt;Are these projects meaningful or impactful?&lt;/li&gt; &lt;li&gt;I am very excited about the XYZ project that Jane Doe is working on. She would be a great mentor for me and XYZ is a top priority of our team. How can I contribute? Would you be supportive of me to involve in that project for my career development?&lt;/li&gt; &lt;/ul&gt; &lt;h5 id=&quot;am-i-happy-on-this-team&quot;&gt;Am I happy on this team?&lt;/h5&gt; &lt;p&gt;Are my peers capable of delivering results? Do they have a strong personality that makes it hard to work with them sometimes? Do they write awesome reviews on my pull requests, or am I tired of their nit-picking?&lt;/p&gt; &lt;h5 id=&quot;am-i-happy-with-my-manager&quot;&gt;Am I happy with my manager?&lt;/h5&gt; &lt;p&gt;Do I get the support I need? Does my manager maintain a healthy cross-functional relationship? Do I wish my manager to lean more toward technical leadership or people management?&lt;/p&gt; &lt;h5 id=&quot;am-i-happy-at-this-company&quot;&gt;Am I happy at this company?&lt;/h5&gt; &lt;p&gt;Are there certain policies I like or dislike? Do I enjoy the culture? Do I trust senior leadership?&lt;/p&gt; &lt;h4 id=&quot;projects-and-processes&quot;&gt;Projects and Processes&lt;/h4&gt; &lt;ul&gt; &lt;li&gt;Instead of providing status updates, ask: Do you feel we have a strong tracking process to keep you updated on the project status?&lt;/li&gt; &lt;li&gt;Are we setting realistic goals? Do you like our quarterly/sprint planning process?&lt;/li&gt; &lt;/ul&gt; </description> <pubDate>Sun, 21 Jun 2020 00:00:00 -0700</pubDate> <link>/one-on-one/</link> <guid isPermaLink="true">/one-on-one/</guid> <category>career</category> </item> <item> <title>The Good, Bad, and Ugly: Istio for Short-lived Pods</title> <description>&lt;p&gt;Kubernetes does not differentiate sidecars and application containers in a Pod. Hence, enabling Istio for short-running workloads imposes additional challenges to the conventional approach of injecting an Envoy sidecar to the istio-enabled Pod.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;The proxy sidecar is long-running and prevents the Pod from finishing even after the application container has completed.&lt;/li&gt; &lt;li&gt;We cannot ensure the proxy to be running and healthy before the application container starts. Without Istio proxy, requests to downstream services may fail if service authentication is enabled, and thus the app container would fail its health check, causing the Pod to be recreated. The pod may be stuck in a crash loop for a while.&lt;/li&gt; &lt;/ul&gt; &lt;h3 id=&quot;straw-man-attempts&quot;&gt;Straw-man attempts&lt;/h3&gt; &lt;p&gt;At first sight, it seems the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;initContainers&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pod&lt;/code&gt; is exactly what we wanted. After all, don’t &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;initContainers&lt;/code&gt; always run before &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;containers&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pod&lt;/code&gt;? Yet, no &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;containers&lt;/code&gt; start until all &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;initContainers&lt;/code&gt; have exited successfully. If we run Istio proxy in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;initContainers&lt;/code&gt;, then we have to kill it manually before the app container could start, which requires the proxy to connect to the service mesh.&lt;/p&gt; &lt;p&gt;Some popular &lt;a href=&quot;https://github.com/istio/istio/issues/11130&quot;&gt;mitigation&lt;/a&gt; I have seen is to change the entrypoint of the app container to wait a few seconds before executing the app binary. But how long of a wait is enough? Starting too soon risks proxy not healthy, but starting too late is a waste of time and resources. Scheduling is never deterministic. Worse, one will have to update the Pod spec themselves, which is not amenable to all the workloads in the cluster.&lt;/p&gt; &lt;h3 id=&quot;an-automated-and-robust-solution&quot;&gt;An Automated and Robust Solution&lt;/h3&gt; &lt;h4 id=&quot;start-pod-mutating-webhook--command-overwrites&quot;&gt;Start Pod: Mutating Webhook + Command Overwrites&lt;/h4&gt; &lt;p&gt;You may build a binary (say, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;valet&lt;/code&gt;) that polls the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/ready&lt;/code&gt; endpoint of the proxy, and then exec the app binary afterwards. We can use the mutating webhook from Kubernetes to automatically rewrite the container command to include &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;valet&lt;/code&gt;. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;valet&lt;/code&gt; binary can be downloaded using a init container and copied to the app container using a shared volume. The following Kubernetes manifest shows this approach.&lt;/p&gt; &lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;na&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;batch/v1&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Job&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;short-lived&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;completions&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;parallelism&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;short-lived&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;annotations&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;sidecar.istio.io/inject&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;true&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;short-lived&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp.com/valet&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;true&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;initContainers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;valet-init&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp/valet:latest&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/bin/sh&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cp /valet /shared/valet&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;volumeMounts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;mountPath&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/shared&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;shared&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;short-lived&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;myapp:latest&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/shared/valet&quot;&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;myapp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;volumeMounts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;shared&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;mountPath&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/shared&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;volumes&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;shared&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;emptyDir&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;{}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h4 id=&quot;finish-pod-pod-exec--kill-proxy&quot;&gt;Finish Pod: Pod Exec + Kill Proxy&lt;/h4&gt; &lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;valet&lt;/code&gt; binary also supports a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-stop-proxy&lt;/code&gt; flag, which will stop Envoy proxy by calling the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/quitquitquit&lt;/code&gt; endpoint on the pilot-agent. In addition to that, the valet controller will be watching all the pods that are labeled as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;myapp.com/valet: &quot;true&quot;&lt;/code&gt;, and it will issue a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;valet -stop-proxy&lt;/code&gt; command when the short-lived containers are all completed. It will essentially be the below call.&lt;/p&gt; &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;kubectl &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$pod&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; short-lived &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; /shared/valet &lt;span class=&quot;nt&quot;&gt;-stop-proxy&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; </description> <pubDate>Sun, 26 Apr 2020 00:00:00 -0700</pubDate> <link>/istio-short/</link> <guid isPermaLink="true">/istio-short/</guid> <category>istio</category> </item> <item> <title>DNS, UDP, IP Anycast, and All That</title> <description>&lt;p&gt;DNS prefers UDP. There are times when DNS must run on TCP (request or response size exceeds a single packet, perhaps due to too many response records), but UDP is perferred if possible. The reasons are&lt;/p&gt; &lt;ul&gt; &lt;li&gt;Constraints from IP Anycasts that favor stateless applications such as DNS.&lt;/li&gt; &lt;li&gt;Performance gain with UDP over TCP (2 vs 11 IP packets, no connection state management).&lt;/li&gt; &lt;/ul&gt; &lt;h3 id=&quot;ip-anycast&quot;&gt;IP Anycast&lt;/h3&gt; &lt;p&gt;Anycast is one of the five &lt;a href=&quot;https://en.wikipedia.org/wiki/Anycast#Addressing_methods&quot;&gt;addressing methods&lt;/a&gt; in IP, where multiple endpoint destinations share the same address. A request to such address expects only one response from any of the destinations. Routers may select the desired path based on costs, latency, and congestion. Another addressing method, Unicast address uniquely identifies a single receiver endpoint.&lt;/p&gt; &lt;p&gt;Anycast can be implemented by using &lt;a href=&quot;https://en.wikipedia.org/wiki/Border_Gateway_Protocol&quot;&gt;Border Gateway Protocol&lt;/a&gt; (BGP) and Unicast. Multiple hosts (likely in different regions) are given the same unicast IP address. Different routes to the address are advertised through BGP, as if they are alternative routes to the same destination when in fact they actually route to different destinations with the same address. As usual, routers select a route by whatever metric (cost, congestion, distance, etc). Selecting a route in this design amounts to selecting a destination.&lt;/p&gt; &lt;p&gt;However, routing changes could break open connections to an anycast address, since IP packets could be routed to a different host that has no context on the connection state (such as TCP sequence numbers). With a normal unicast address, a routing change is not a problem at all, as packets eventually arrive at the same destination.&lt;/p&gt; &lt;p&gt;Hence, anycast is often used with connection-less protocols to provide high availability and load balancing for stateless services. DNS is a great fit. The root name servers need to be accessible at a well-known address (or we need another name server to find these name servers but what is the address to that name server?). The actual backend serving the query should be as close as possible to reduce response latency (as DNS lookup is often in the hot path before TCP, TLS, and finally HTTP).&lt;/p&gt; &lt;h3 id=&quot;udp&quot;&gt;UDP&lt;/h3&gt; &lt;p&gt;UDP is best-effort (unreliable) and packets may be delivered out-of-order. However, a DNS query usually fits in a single packet and does not require an ordered byte stream. Hence, out-of-order delivery is not an issue; checksum and retransmission are enough to ensure integrity. In comparison, queries over TCP require 11 IP packets to complete:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;Three-way handshake to establish connection (SYN, SYN-ACK, ACK)&lt;/li&gt; &lt;li&gt;Query by client, ACK by server&lt;/li&gt; &lt;li&gt;Response by server, ACK by client&lt;/li&gt; &lt;li&gt;Four-way handshake to close connection (FIN, ACK, FIN, ACK)&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Using UDP allows the name server to scale better because it does not allocate or manage connection states, such as Receive and Send buffers, Sequence and Acknowledge Numbers, and flow-control and congestion-control parameters, etc.&lt;/p&gt; </description> <pubDate>Sun, 05 Apr 2020 00:00:00 -0700</pubDate> <link>/dns-udp/</link> <guid isPermaLink="true">/dns-udp/</guid> <category>networking</category> </item> <item> <title>Lessons from Scaling GKE: L4 ILB Tops at 250 Nodes</title> <description>&lt;p&gt;My team at Cruise operates tens of Kubernetes clusters with 10,000s cores and 100s of TB of RAM. Since migration to GCP, we have hit several interesting scaling issues. One of those caused cluster-wide ingress outage for all tenants. In this post, I will revisit the symptom, root cause, and mitigations for this incident. We struggled so you do not have to.&lt;/p&gt; &lt;h3 id=&quot;architecture-private-ingress-with-ilb-and-nginx-controller&quot;&gt;Architecture: Private Ingress with ILB and Nginx Controller&lt;/h3&gt; &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt; Client | | L3/L4 | v Internal TCP/UDP Load Balancer | | L7 HTTP | --------------+------------------ | | | | v | | Nginx Ingress Controllers | | | | | | L7 HTTP | | | | | v | | Pods | |GKE | --------------------------------- &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h3 id=&quot;symptom&quot;&gt;Symptom&lt;/h3&gt; &lt;p&gt;The Internal Load Balancer (ILB) used for private ingress in the cluster stopped responding to connections. New connection requests hung (e.g. curl &amp;amp; traceroute) except for requests originated from within the cluster.&lt;/p&gt; &lt;h3 id=&quot;root-causes&quot;&gt;Root Causes&lt;/h3&gt; &lt;ol&gt; &lt;li&gt; &lt;p&gt;Currently, L4 ILB only supports at most 250 backends (&lt;a href=&quot;https://cloud.google.com/load-balancing/docs/quotas#backend_services&quot;&gt;source&lt;/a&gt;). The Kubernetes cloud provider that controls ILB creation sets all Kubernetes nodes in the cluster as ILB backends. As a result, the maximum number of GKE nodes that gets traffic from the ILB is 250. When more than 250 nodes present in the GKE cluster, ILB will deterministically (using node ID) select a subset of 250 backends for healthcheck.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;The Nginx controllers are deployed in the cluster as well. They use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;externalTrafficPolicy: local&lt;/code&gt; to bypass iptables and sends traffic directly to any pods located on the host. From the perspective of the ILB every node that has the destination pod will be healthy and ones that do not will be permanently unhealthy.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;A tenant workload scale-up caused the number of nodes in the cluster to autoscale above 250. None of the nodes that Nginx resides on were selected by the ILB. As a result, the ILB considered all nodes in the subset as unhealthy. When all ILB backends are unhealthy, no traffic through the ILB will be passed to the cluster.&lt;/p&gt; &lt;/li&gt; &lt;/ol&gt; &lt;h3 id=&quot;mitigations&quot;&gt;Mitigations&lt;/h3&gt; &lt;h4 id=&quot;immediate&quot;&gt;Immediate&lt;/h4&gt; &lt;p&gt;In order to immediately restore cluster ingress service, another ILB was manually created using the cluster’s well-known ingress IP address. This ILB was configured to point to a couple instance groups such that the number of backing nodes did not exceed the limit of 250.&lt;/p&gt; &lt;h4 id=&quot;short-term&quot;&gt;Short-term&lt;/h4&gt; &lt;p&gt;One could deploy a cluster with larger nodes (vertical scaling) in the hope that the total number of nodes will be within 250.&lt;/p&gt; &lt;p&gt;Alternatively, one may use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;externalTrafficPolicy: cluster&lt;/code&gt; so Nginx service will use kube-proxy/iptables to load balance traffic to the correct pod(s) regardless of which node traffic lands on in the cluster. The downside of this solution is that&lt;/p&gt; &lt;ul&gt; &lt;li&gt;Extra latency. When the ILB is sending traffic to the 250-node subset, traffic will go through a second hop to get to the destination pod IPs.&lt;/li&gt; &lt;li&gt;Less secure, because it requires opening firewalls for port 80/443 on all nodes.&lt;/li&gt; &lt;li&gt;The client source IP is not preserved, because of the iptables hop.&lt;/li&gt; &lt;/ul&gt; &lt;h4 id=&quot;long-term&quot;&gt;Long-term&lt;/h4&gt; &lt;p&gt;Move Nginx controllers out of the cluster and into a GCE instance group, so ILB healthcheck will be done properly.&lt;/p&gt; </description> <pubDate>Fri, 20 Mar 2020 00:00:00 -0700</pubDate> <link>/gke-scaling/</link> <guid isPermaLink="true">/gke-scaling/</guid> <category>kubernetes</category> </item> <item> <title>Parameters with Defaults in Go: Functional Options</title> <description>&lt;p&gt;Unlike C++ or Python, Go does not support function parameters with default values if unspecified. Specifically, we want that&lt;/p&gt; &lt;ul&gt; &lt;li&gt;Passing multiple parameters is supported.&lt;/li&gt; &lt;li&gt;Interface remains backward-compatible when the number of type of one or more parameter changes.&lt;/li&gt; &lt;li&gt;Parameters have default values that can be overridden.&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;In search of a general and elegant solution to this problem, we present a few straw-man approaches as motivations for the functional options and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;With*()&lt;/code&gt; pattern, which are presented last.&lt;/p&gt; &lt;h3 id=&quot;straw-man&quot;&gt;Straw-man&lt;/h3&gt; &lt;h4 id=&quot;update-function-signature-to-accept-more-inputs&quot;&gt;Update function signature to accept more inputs&lt;/h4&gt; &lt;p&gt;Suppose you have the following &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Foo&lt;/code&gt; struct with the most basic constructor &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;New()&lt;/code&gt;.&lt;/p&gt; &lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 8 9 10 11 12 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// ... initialization&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;Imagine that we want to add more fields to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Foo&lt;/code&gt; and therefore to change the constructor into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;func New(num, num2 int, str, str2 string, bar *Bar) *Foo&lt;/code&gt;. Not only is this function incompatible with existing calls, it also becomes less readable as we add more parameters.&lt;/p&gt; &lt;h4 id=&quot;keep-the-old-functions&quot;&gt;Keep the old functions&lt;/h4&gt; &lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 8 9 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num2&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str2&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bar&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;/* ... */&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num2&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str2&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;/* ... */&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;We could keep the old functions while adding new ones to support more fields, but it also means the total number of functions grows exponentially (power of 2) with the number of parameters, since each parameter could be included or excluded in a function. Our file would soon become unmaintainable.&lt;/p&gt; &lt;h4 id=&quot;putting-all-params-in-a-struct&quot;&gt;Putting all params in a struct&lt;/h4&gt; &lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Option&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Option&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Num&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Str&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Default values for Foo.&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;hello&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Set overwrites.&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Num&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Str&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;Doing so addresses the compatibility issue and seems to achieve default values. However, it is impossible to determine whether the function caller explicitly sets &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;opt.Num&lt;/code&gt; to zero or did not specify &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Num&lt;/code&gt; at all and therefore using the default value &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;10&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;In fact, such confusion around zero-value as input happens not just for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Option&lt;/code&gt; struct but whenever and whatever parameters are passed directly to functions.&lt;/p&gt; &lt;h4 id=&quot;passing-a-struct-pointer&quot;&gt;Passing a struct pointer&lt;/h4&gt; &lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Use all values in opt to create Foo.&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Use all default values.&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nil&lt;/code&gt; pointer is a good way distinguish set vs unset. However, The new problem is that either all fields need to use the default values or none of them does. Hence, if the user only wants to overwrite one parameter and use defaults for the rest, the user must supply the default values for other fields explicitly. Yikes.&lt;/p&gt; &lt;h4 id=&quot;make-all-fields-pointers&quot;&gt;Make all fields pointers&lt;/h4&gt; &lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Option&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newFooWithDefaults&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;Since the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nil&lt;/code&gt; pointer is a good way distinguish set vs unset, making all the fields a pointer seems to do the trick. However, this is not user-friendly at all, because in Go there is no such thing as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;20&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;&quot;hello&quot;&lt;/code&gt;and the call must assign the literal value to a temporary variable and then take its address. Not pretty.&lt;/p&gt; &lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;hello&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h4 id=&quot;variadic-functions&quot;&gt;Variadic functions&lt;/h4&gt; &lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Did not provide num2, use default.&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Use num2[0].&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;p&gt;This alternative approach only works with one optional parameter with dirty semantics, such as the behavior if &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;len(num2) &amp;gt; 1&lt;/code&gt;.&lt;/p&gt; &lt;h3 id=&quot;functional-options&quot;&gt;Functional Options&lt;/h3&gt; &lt;p&gt;Finally, we arrive at the functional options pattern that solves optional params (or params with defaults) nicely.&lt;/p&gt; &lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 &lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Num&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Str&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Option&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WithNum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Option&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WithStr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Option&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;someRequiredField&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;applyOpt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;range&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;applyOpt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;important&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WithNum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;required&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WithNum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WithStr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt; &lt;h3 id=&quot;more-go-tips&quot;&gt;More Go Tips&lt;/h3&gt; &lt;p&gt;Love what you are reading? My wiki pages have more battle-tested Go lessons:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;&lt;a href=&quot;/wiki/go/snippets/&quot;&gt;Useful Go Snippets&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;/wiki/go/pitfalls/&quot;&gt;Go Common Pitfalls&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;/wiki/go/development/&quot;&gt;More Effective Go&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;/wiki/go/production/&quot;&gt;Production-ready Go&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; </description> <pubDate>Sun, 01 Mar 2020 00:00:00 -0800</pubDate> <link>/go-opts/</link> <guid isPermaLink="true">/go-opts/</guid> <category>go</category> </item> </channel> </rss>